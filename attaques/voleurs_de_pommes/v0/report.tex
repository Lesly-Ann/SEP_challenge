\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}   
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{fancyvrb}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}	
\usepackage{msc}

% Setting for MSC diagrams
\setlength{\levelheight}{0.6cm}
\setlength{\instdist}{4.5cm}
\setlength{\actionwidth}{1.5cm}


\author{
Lesly-Ann Daniel \and Benjamin Fasquelle \and RÃ©mi Hutin\\
}
\title{
Attack on: voleurs de pommes\\
From group \textsc{BALEC}
}

\setlength\parindent{0pt}

\begin{document}
\maketitle


\section{Description of the Attack}
\begin{table}[!h]
\centering
\begin{tabular}{lll}
$Bob \rightarrow Server:$ & $ Bob,\{Alice,K\}pk(Bob,Server) $ & \#run1 (Bob is the initial sender) \\
$Eve(Server) \rightarrow Bob:$ & $ Server,\{Alice,K\}pk(Bob,Server) $ & \#run2 (Alice is the initial sender) \\
$Bob \rightarrow Alice:$ & $ Bob,\{Bob\}K $ & \#run2 (Alice is the initial sender) \\
\end{tabular}
\end{table}

\paragraph{Description}
Alice, Bob and the server are honest agents and Eve is dishonest.
\begin{itemize}
 \item Bob initiates a connexion with Alice. The message is intercepted by Eve.
 \item In athe second run the roles are different: Alice is the initial sender and Bob is supposed to receive a message from the server. Eve can reuse the previous message with key \(K\) encrypted with the private key of Bob and the server to build the second message for Bob. Then she sends this message to Bob pretending that she is the Server.
 \item Finally when Bob receives this message, he thinks that Alice wants to communicate with him and respond with the last message.
\end{itemize}

At the end of the protocol, Bob terminates thinking he has communicated with Alice and the Server but he actually communicated with Eve. The {\em agreement} is violated since the messages received by Bob were not sent by the Server.

% \begin{figure}[!ht]
% \centering
% \begin{msc}{Protocole}
%   \declinst{A}{$A$}{}
%   \declinst{B}{$B$}{}
%   \nextlevel
%   \action{secret $K$}{A}
%   \nextlevel[2]
%   \mess{$\langle h(A, K), \{K\}_{pk(B)} \rangle $}{A}{B}
%   \nextlevel
%   \action{nonce $n$}{B}
%   \nextlevel[2]
%   \mess{$\langle h(B, K, n), \{n\}_{pk(A)} \rangle $}{B}{A}
%   \nextlevel
%   \mess{$h(n)$}{A}{B}
%   \nextlevel
% \end{msc}
% \end{figure}

\end{document}
