\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}   
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{fancyvrb}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}	
\usepackage{msc}

% Setting for MSC diagrams
\setlength{\levelheight}{0.6cm}
\setlength{\instdist}{4.5cm}
\setlength{\actionwidth}{1.5cm}


\author{
Lesly-Ann Daniel \and Benjamin Fasquelle \and RÃ©mi Hutin\\
}
\title{
Attack on: En y v0\\
From group \textsc{BALEC}
}

\setlength\parindent{0pt}

\begin{document}
\maketitle


\section{Description of the Attack}
\begin{table}[!h]
\centering
\begin{tabular}{lll}
$Bob \rightarrow Alice:$ & $ (\{ K,Bob \}pk(Alice),h(K),\{ n1 \}pk(Alice))$ & \#intercepted\\
$Charlie(Bob) \rightarrow Alice:$ & $ (\{ K',Bob \}pk(Alice),h(K'),\{ n1 \}pk(Alice))$ &\\
$Alice \rightarrow Bob:$ & $ (\{ n2,Alice \}pk(Bob),n1) $ &\\
$Bob \rightarrow Alice:$ & $ n2 $ &\\
\end{tabular}
\end{table}

\paragraph{Description}
Alice and Bob are honest agents and Charlie is dishonest.
\begin{itemize}
 \item Bob initiates a connexion with Alice. The message is intercepted by Charlie.
 \item Charlie generates its own secret $K'$ and reuses the nonce generated by Bob and encrypted with Alice private key. He forges a new message with those information and sends it to Alice, pretending he is Bob.
 \item Alice thinks she is communicating with Bob and she decrypts the secret $K'$ that has actually been generated by Charlie. She pursues the protocol with Bob: she decrypts the nonce $n1$ from Bob and sends her new nonce $n2$.
 \item Finally Bob sends the nonce $n2$ back to Alice.
\end{itemize}

In this attack, Alice terminates the execution of the protocol thinking that she communicated with Bob, when she actually communicated with Charlie. The {\em secrecy} of the key $K'$ is violated since it has been generated by the attacker. The {\em agreement} is also violated since Alice and Bob thought they agreed on the value of the secret $K$ but actually didn't.

% \begin{figure}[!ht]
% \centering
% \begin{msc}{Protocole}
%   \declinst{A}{$A$}{}
%   \declinst{B}{$B$}{}
%   \nextlevel
%   \action{secret $K$}{A}
%   \nextlevel[2]
%   \mess{$\langle h(A, K), \{K\}_{pk(B)} \rangle $}{A}{B}
%   \nextlevel
%   \action{nonce $n$}{B}
%   \nextlevel[2]
%   \mess{$\langle h(B, K, n), \{n\}_{pk(A)} \rangle $}{B}{A}
%   \nextlevel
%   \mess{$h(n)$}{A}{B}
%   \nextlevel
% \end{msc}
% \end{figure}

\end{document}
